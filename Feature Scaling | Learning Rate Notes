

import numpy as np
import matplotlib.pyplot as plt
from lab_utils_multi import  load_house_data, run_gradient_descent 
from lab_utils_multi import  norm_plot, plt_equal_scale, plot_cost_i_w
from lab_utils_common import dlc
np.set_printoptions(precision=2)
plt.style.use('./deeplearning.mplstyle')

"""
Notation
General
Notation	                                                                                        Description	          Python (if applicable)

  ğ‘	                                                                                        scalar, non bold	
  
  ğš	                                                                                            vector, bold	
  
  ğ€	                                                                                    matrix, bold capital	
  
  Regression		
  
  ğ—	                                                                                training example maxtrix	          X_train
  
  ğ²	                                                                                training example targets	          y_train
  
  ğ±(ğ‘–),ğ‘¦(ğ‘–)	                                                                              ğ‘–ğ‘¡â„ Training Example	        X[i], y[i]
  
  m	                                                                              number of training examples	                 m
  
  n	                                                                       number of features in each example	                 n
  
  ğ°	                                                                                      parameter: weight,	               w
  
  ğ‘	                                                                                         parameter: bias	                b
  
  ğ‘“ğ°,ğ‘(ğ±(ğ‘–))	            The result of the model evaluation at ğ±(ğ‘–) parameterized by ğ°,ğ‘: ğ‘“ğ°,ğ‘(ğ±(ğ‘–))=ğ°â‹…ğ±(ğ‘–)+ğ‘	               f_wb
  
  âˆ‚ğ½(ğ°,ğ‘)/âˆ‚ğ‘¤ğ‘—	                       the gradient or partial derivative of cost with respect to a parameter ğ‘¤ğ‘—	          dj_dw[j]
  
  âˆ‚ğ½(ğ°,ğ‘)/âˆ‚ğ‘	                         the gradient or partial derivative of cost with respect to a parameter ğ‘	             dj_db
"""

"""
Problem Statement

As in the previous labs, you will use the motivating example of housing price prediction. The training data set contains many examples with 4 features 
(size, bedrooms, floors and age) shown in the table below. Note, in this lab, the Size feature is in sqft while earlier labs utilized 1000 sqft.
This data set is larger than the previous lab.

We would like to build a linear regression model using these values so we can then predict the price for other houses - say, a house with 1200 sqft, 3 bedrooms,
1 floor, 40 years old.

Dataset:

Size (sqft)	Number of Bedrooms	Number of floors	  Age of Home	  Price (1000s dollars)
     952	          2	                  1	                65	          271.5
     1244 	        3	                  2	                64	            232
     1947 	        3	                  2	                17	          509.8
      ...	...	...	...	...
"""


# load the dataset
X_train, y_train = load_house_data()
X_features = ['size(sqft)','bedrooms','floors','age']


fig,ax=plt.subplots(1, 4, figsize=(12, 3), sharey=True)
for i in range(len(ax)):
    ax[i].scatter(X_train[:,i],y_train)
    ax[i].set_xlabel(X_features[i])
ax[0].set_ylabel("Price (1000's)")
plt.show()

# Plotting each feature vs. the target, price, provides some indication of which features have the strongest influence on price. Above, increasing size also increases
# price. Bedrooms and floors don't seem to have a strong impact on price. Newer houses have higher prices than older houses.



"""
Gradient Descent With Multiple Variables

Here are the equations you developed in the last lab on gradient descent for multiple variables.:

repeat until convergence:  {ğ‘¤ğ‘— := ğ‘¤ğ‘—âˆ’ğ›¼(âˆ‚ğ½(ğ°,ğ‘)/âˆ‚ğ‘¤ğ‘—)   ğ‘ := ğ‘âˆ’ğ›¼(âˆ‚ğ½(ğ°,ğ‘)/âˆ‚ğ‘ | for j = 0..n-1}    (1)

where, n is the number of features, parameters ğ‘¤ğ‘—, ğ‘, are updated simultaneously and where
                   ğ‘š-1
(âˆ‚ğ½(ğ°,ğ‘)/âˆ‚ğ‘¤ğ‘—) = 1  âˆ‘(ğ‘“ğ°,ğ‘(ğ±(ğ‘–))âˆ’ğ‘¦(ğ‘–))ğ‘¥j(i)     (2)
                ğ‘š  ğ‘–=0
                
                   ğ‘š-1
(âˆ‚ğ½(ğ°,ğ‘)/âˆ‚b) = 1   âˆ‘(ğ‘“ğ°,ğ‘(ğ±(ğ‘–))âˆ’ğ‘¦(ğ‘–))     (3)
               ğ‘š   ğ‘–=0
               
- m is the number of training examples in the data set

- ğ‘“ğ°,ğ‘(ğ±(ğ‘–)) is the model's prediction, while ğ‘¦(ğ‘–) is the target value
"""

